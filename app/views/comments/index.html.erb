<h1>コメント一覧</h1>
<div class='container'>
  <div class='row'>
    <div class="col-sm-12 col-md-8 col-lg-5 px-5 px-sm-0 mx-auto">
      <div>
        <% @comments.each do |post| %>
         <p><%= post.comment %></p>
         <div id="review-rating<%= post.id %>" data-score="<%= post.rate %>">評価：</div>
          <% if post.customer == current_customer %>
            <div>
             <%= link_to "削除", anime_post_path(post.anime, post), method: :delete %>
            </div>
          <% end %>
          <script>
          $('#review-rating<%= post.id %>').raty({
            readOnly: true,
            score: function() {
              return $(this).attr('data-score');
            },
            path: '/assets/'
          });
         </script>

        <% end %>
      </div>
    </div>
  </div>
</div>
<div id="average-review-rating" data-score=<%= @comments.average(:rate).to_f.round(1) %>></div>

<script>
 $('#average-review-rating').raty({
    size: 36,
    starOn: "<%= asset_path('star-on.png') %>",
    starOff: "<%= asset_path('star-off.png') %>",
    starHalf: "<%= asset_path('star-half.png') %>",
    half: true,
    readOnly: true,
    score: "comment[rate]",
    //注目ポイント↑ 平均点を算出し、round関数で切り上げ
  });
</script>